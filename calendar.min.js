(function(){function a(){var a=this,b,c,d,e,f,g,h,i,j,k={},l,m,n,o,p,q,r=0,s="click",t="noAnimationEnd",u=typeof Modernizr!=='undefined'&&Modernizr.csstransforms3d?"webkit moz o ms khtml ".split(" ").join("AnimationEnd ")+"animationEnd":t,v="startDate",w="endDate",x="multipleDates",y=function(a,b){for(var c=0,d=b.length;c<d;c++){if(a&&b[c]&&a.getTime()===b[c].getTime()){return c}}return-1},z=function(a,c){c&&c.clearTime&&c.clearTime();if(a==x){var d=false;if(c===null){k=[]}else{var e=y(c,k);if(e!==-1){k.splice(e,1)}else{k.push(c);d=true}}b.data(a.toLowerCase(),JSON.stringify(k)).trigger(a+"Changed",{dates:k,changedDate:c}).trigger(a+(d?"Added":"Removed"),{dates:k,changedDate:c})}else{if(a==v){i=c}else{j=c}b.data(a.toLowerCase(),!c?"":c.toString());b.trigger(a+"Changed")}D()},A=function(a){a.preventDefault();var b=$(this);if(b.hasClass("inactive")||b.text().length==0){return}var c=new Date(l.getFullYear(),l.getMonth(),parseInt(b.text()));if(p){z(v,!i||c.getTime()!=i.getTime()?c:null);return}else if(q){z(x,c);return}if(!i){if(!j){z(v,c)}else{if(c<j){z(v,c)}else if(j<c){z(v,j);z(w,c)}else{z(w,null)}}}else if(!j){if(i<c){z(w,c)}else if(c<i){z(w,i);z(v,c)}else{z(v,null)}}else{if(b.hasClass(v)){z(v,null)}else if(b.hasClass(w)){z(w,null)}else{z(v,null);z(w,null)}}},B=function(){Date.prototype.clone=function(){return new Date(this.getTime())};Date.prototype.isLeapYear=function(){var a=this.getFullYear();return a%4===0&&a%100!==0||a%400===0};Date.prototype.getDaysInMonth=function(){return[31,this.isLeapYear(this.getFullYear())?29:28,31,30,31,30,31,31,30,31,30,31][this.getMonth()]};Date.prototype.moveToFirstDayOfMonth=function(){this.setDate(1);return this};Date.prototype.moveToLastDayOfMonth=function(){this.setDate(this.getDaysInMonth());return this};Date.prototype.addMilliseconds=function(a){this.setMilliseconds(this.getMilliseconds()+a);return this};Date.prototype.addDays=function(a){return this.addMilliseconds(a*864e5)};Date.prototype.addMonths=function(a){var b=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+a);this.setDate(Math.min(b,this.getDaysInMonth()));return this};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this}},C=function(a){return(a+r)%7},D=function(){g.removeClass(v).removeClass(w).removeClass(x).removeClass("betweenDates");var a=l.clone().moveToFirstDayOfMonth();var b=l.clone().moveToLastDayOfMonth();var c=C(a.getDay())-1;if(!!i&&!!j&&i<b&&j>a){var d=new Date(Math.max(a,i.clone().addDays(1)));var e=new Date(Math.min(b,j.clone().addDays(-1)));if(d<=e){g.slice(c+d.getDate(),c+e.getDate()+1).addClass("betweenDates")}}if(!!i&&a<=i&&i<=b){g.eq(c+i.getDate()).addClass(v)}if(!!j&&a<=j&&j<=b){g.eq(c+j.getDate()).addClass(w)}for(var f in k){if(!!k[f]&&a<=k[f]&&k[f]<=b){g.eq(c+k[f].getDate()).addClass(x)}}};a.ready=function(y){b=y;c=$('<a href="#"><</a>');d=$('<a href="#">></a>');e=$('<li class="calMonth"></li>');b.append($('<ul class="calButtonBar"></ul>').append($('<li class="calPrevious"></li>').append(c)).append(e).append($('<li class="calNext"></li>').append(d)));for(var C=0,D="",E="";C<7;C++){D+="<th></th>";E+='<td><a href="#"></a></td>'}for(var C=0,F="";C<6;C++){F+="<tr>"+E+"</tr>"}b.append('<div class="calGrid"><table><tr>'+D+"</tr>"+F+"</table></div>");f=b.find("th");g=b.find("td a");h=b.find("tr");h.eq(1).addClass("first");p=b.hasClass("jsSingleDate");q=b.hasClass("jsMultipleDates");r=b.data("firstdayofweek")||r;b.get(0).calendar=a;if($.fn){$.fn.slice=$.fn.slice||function(a,b){return $([].slice.call(this,a,b))};$.fn.calendar=function(){return this.get(0).calendar}}B();m=(new Date).clearTime();n=m;i=b.data("startdate");i=i?(new Date(i)).clearTime():null;j=b.data("enddate");j=j?(new Date(j)).clearTime():null;k=b.data("multipledates");if(typeof k=="string"){k=JSON.parse(k)}for(var C in k){k[C]=(new Date(k[C])).clearTime()}i=k?k[0]:i;l=(i||m).clone();o=b.data("localized_date");if(typeof o=="string"){o=JSON.parse(o)}var G=b.find(".calGrid");var H=[];var I=function(a){if(G.children().length>1){H.push(a);return true}return false};var J=function(){if(H.length>0){setTimeout(function(){H.shift().trigger(s)},0)}};c.bind(s,function(d){d.preventDefault();if(I(c))return;l=l.addMonths(-1);var e=$("<table>"+b.find("table").html()+"</table>");G.append(e);g.closest("table").addClass("turndown").bind(u,function(a){$(this).removeClass("turndown").unbind(u);e.remove();J()}).trigger(t);a.showMonth(l)});d.bind(s,function(c){c.preventDefault();if(I(d))return;l=l.addMonths(+1);var e=$('<table class="turnup">'+b.find("table").html()+"</table>");G.append(e);e.bind(u,function(a){e.remove();J()}).trigger(t);a.showMonth(l)});b.bind("resetDates",function(a){z(v,null);z(w,null);q&&z(x,null)});g.bind(s,A);a.showMonth(l)};a.setDates=function(a,b){if(q){a=a&&a.constructor===Array?a:[a];for(var c=0,d=a.length;c<d;c++){z(x,a[c])}}else{z(v,a&&b?new Date(Math.min(a,b)):a);!p&&z(w,a&&b?a.getTime()!=b.getTime()?new Date(Math.max(a,b)):null:b)}};a.showMonth=function(a){n=new Date(Math.max(n,m));if(!!o){e.text(o.months.names["long"][a.getMonth()]+" "+a.getFullYear());for(var b=0,c=f.length;b<c;b++){f.eq(C(b)).text(o.days.names.min[b])}}var d=n>a.clone().moveToLastDayOfMonth();var i=!d&&n>=a.clone().moveToFirstDayOfMonth();var j=n.getDate();g.addClass("noTransition").removeClass("inactive");h.removeClass("last").removeClass("hidden");for(var k=C(a.clone().moveToFirstDayOfMonth().getDay())-1,l=k+a.clone().moveToLastDayOfMonth().getDate(),b=0,c=g.length;b<c;b++){var p=b>k&&b<=l;var q=g.eq(b).text(p?""+(b-k):"");if(p&&(d||i&&b-k<j)){q.addClass("inactive")}if(i&&m.getDate()==b-k){q.addClass("today")}if(b==l){q.closest("tr").addClass("last").next().addClass("hidden").next().addClass("hidden")}}setTimeout(function(){g.removeClass("noTransition")},0);D()}}$(document).ready(function(){var b=$(".jsCalendar");for(var c=0,d=b.length;c<d;c++){var e=new a;e.ready(b.eq(c))}})})()